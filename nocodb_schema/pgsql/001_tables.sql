-- Requires extension pgcrypto for gen_random_uuid()
CREATE EXTENSION IF NOT EXISTS pgcrypto;

-- Generated by airtable_export_to_postgres_sql_v2.js
-- 2026-01-25T18:13:56.498Z
BEGIN;
CREATE SCHEMA IF NOT EXISTS "public";

CREATE TABLE IF NOT EXISTS "public"."strains" (
  "nocopk" BIGSERIAL PRIMARY KEY,
  "nocouuid" uuid DEFAULT gen_random_uuid(),
  "airtable_id" text UNIQUE,
  "nc_created_at" timestamp without time zone DEFAULT now(),
  "nc_updated_at" timestamp without time zone DEFAULT now(),
  "strain_id" text,
  "species_strain" text,
  "regulated" boolean
);

CREATE TABLE IF NOT EXISTS "public"."recipes" (
  "nocopk" BIGSERIAL PRIMARY KEY,
  "nocouuid" uuid DEFAULT gen_random_uuid(),
  "airtable_id" text UNIQUE,
  "nc_created_at" timestamp without time zone DEFAULT now(),
  "nc_updated_at" timestamp without time zone DEFAULT now(),
  "recipe_id" text,
  "name" text,
  "category" text,
  "ingredients" text,
  "notes" text
);

CREATE TABLE IF NOT EXISTS "public"."products" (
  "nocopk" BIGSERIAL PRIMARY KEY,
  "nocouuid" uuid DEFAULT gen_random_uuid(),
  "airtable_id" text UNIQUE,
  "nc_created_at" timestamp without time zone DEFAULT now(),
  "nc_updated_at" timestamp without time zone DEFAULT now(),
  "name_mat" text,
  "item_category_mat" text,
  "net_weight_g" numeric,
  "net_weight_oz" numeric,
  "net_volume_ml" numeric,
  "pack_date" date,
  "use_by" date,
  "package_size_g" numeric,
  "package_count" numeric,
  "action" text,
  "origin_lot_ids_json" text,
  "ui_error" text,
  "ui_error_at" timestamp without time zone,
  "tray_state" text,
  "notes" text
);

CREATE TABLE IF NOT EXISTS "public"."lots" (
  "nocopk" BIGSERIAL PRIMARY KEY,
  "nocouuid" uuid DEFAULT gen_random_uuid(),
  "airtable_id" text UNIQUE,
  "nc_created_at" timestamp without time zone DEFAULT now(),
  "nc_updated_at" timestamp without time zone DEFAULT now(),
  "item_name_mat" text,
  "qty" numeric,
  "unit_size" numeric,
  "status" text,
  "parents_json" text,
  "operator" text,
  "created_at" timestamp without time zone,
  "use_by" date,
  "action" text,
  "item_category_mat" text,
  "process_type_mat" text,
  "lc_volume_ml" numeric,
  "output_count" numeric,
  "fruiting_goal" text,
  "flush_no" numeric,
  "harvest_weight_g" numeric,
  "notes" text,
  "syringe_count" numeric,
  "source_type" text,
  "vendor_name" text,
  "vendor_batch" text,
  "received_date" date,
  "total_volume_ml" numeric,
  "ui_error" text,
  "ui_error_at" timestamp without time zone,
  "remaining_volume_ml" numeric,
  "fresh_tray_count" numeric,
  "frozen_tray_count" numeric,
  "casing_applied_at" timestamp without time zone,
  "casing_notes" text,
  "casing_qty_used_g" numeric,
  "label_template" text,
  "override_inoc_time" timestamp without time zone,
  "inoculated_at" timestamp without time zone,
  "override_spawn_time" timestamp without time zone,
  "spawned_at" timestamp without time zone,
  "sterilized_at" timestamp without time zone,
  "plate_count" numeric,
  "plate_group_id" text
);

CREATE TABLE IF NOT EXISTS "public"."items" (
  "nocopk" BIGSERIAL PRIMARY KEY,
  "nocouuid" uuid DEFAULT gen_random_uuid(),
  "airtable_id" text UNIQUE,
  "nc_created_at" timestamp without time zone DEFAULT now(),
  "nc_updated_at" timestamp without time zone DEFAULT now(),
  "item_id" text,
  "name" text,
  "category" text,
  "default_unit_size_lb" numeric,
  "default_unit_size_ml" numeric,
  "default_unit_size_oz" numeric,
  "default_unit_size_g" numeric,
  "default_unit_size" text
);

CREATE TABLE IF NOT EXISTS "public"."events" (
  "nocopk" BIGSERIAL PRIMARY KEY,
  "nocouuid" uuid DEFAULT gen_random_uuid(),
  "airtable_id" text UNIQUE,
  "nc_created_at" timestamp without time zone DEFAULT now(),
  "nc_updated_at" timestamp without time zone DEFAULT now(),
  "type" text,
  "timestamp" timestamp without time zone,
  "operator" text,
  "station" text,
  "fields_json" text,
  "lots" text
);

CREATE TABLE IF NOT EXISTS "public"."locations" (
  "nocopk" BIGSERIAL PRIMARY KEY,
  "nocouuid" uuid DEFAULT gen_random_uuid(),
  "airtable_id" text UNIQUE,
  "nc_created_at" timestamp without time zone DEFAULT now(),
  "nc_updated_at" timestamp without time zone DEFAULT now(),
  "name" text,
  "type" text,
  "notes" text
);

CREATE TABLE IF NOT EXISTS "public"."sterilization_runs" (
  "nocopk" BIGSERIAL PRIMARY KEY,
  "nocouuid" uuid DEFAULT gen_random_uuid(),
  "airtable_id" text UNIQUE,
  "nc_created_at" timestamp without time zone DEFAULT now(),
  "nc_updated_at" timestamp without time zone DEFAULT now(),
  "start_time" timestamp without time zone,
  "end_time" timestamp without time zone,
  "operator" text,
  "planned_count" numeric,
  "good_count" numeric,
  "destroyed_count" numeric,
  "planned_unit_size" numeric,
  "ui_error" text,
  "ui_error_at" timestamp without time zone,
  "process_type" text,
  "target_temp_c" numeric,
  "pressure_mode" text,
  "override_end_time" timestamp without time zone
);

CREATE TABLE IF NOT EXISTS "public"."print_queue" (
  "nocopk" BIGSERIAL PRIMARY KEY,
  "nocouuid" uuid DEFAULT gen_random_uuid(),
  "airtable_id" text UNIQUE,
  "nc_created_at" timestamp without time zone DEFAULT now(),
  "nc_updated_at" timestamp without time zone DEFAULT now(),
  "source_kind" text,
  "print_status" text,
  "label_type" text,
  "error_msg" text,
  "created_at" timestamp without time zone,
  "claimed_by" text,
  "claimed_at" timestamp without time zone,
  "printed_by" text,
  "printed_at" timestamp without time zone,
  "pdf_path" text
);

CREATE TABLE IF NOT EXISTS "public"."ecommerce" (
  "nocopk" BIGSERIAL PRIMARY KEY,
  "nocouuid" uuid DEFAULT gen_random_uuid(),
  "airtable_id" text UNIQUE,
  "nc_created_at" timestamp without time zone DEFAULT now(),
  "nc_updated_at" timestamp without time zone DEFAULT now(),
  "name" text,
  "status" text,
  "ecwid_sku" text,
  "sync_to_ecwid" boolean,
  "notes" text,
  "ecwid_category" text,
  "ecwid_price" numeric,
  "ecwid_stock" numeric,
  "ecwid_url" text,
  "ecwid_image" jsonb
);

CREATE TABLE IF NOT EXISTS "public"."ecommerce_orders" (
  "nocopk" BIGSERIAL PRIMARY KEY,
  "nocouuid" uuid DEFAULT gen_random_uuid(),
  "airtable_id" text UNIQUE,
  "nc_created_at" timestamp without time zone DEFAULT now(),
  "nc_updated_at" timestamp without time zone DEFAULT now(),
  "name" text,
  "ecwid_order_id" text,
  "order_number" numeric,
  "status" text,
  "order_date" timestamp without time zone,
  "customer_name" text,
  "customer_email" text,
  "items_json" text,
  "ecwid_skus" text
);
COMMIT;
